<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مدرب قواعد اللغة الإنجليزية</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1d4ed8;
            --background-color: #f3f4f6;
            --card-background: #ffffff;
            --text-color: #1f2937;
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', Arial, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .section {
            background: var(--card-background);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        /* .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        } */

        h2 {
            color: var(--text-color);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
            display: inline-block;
        }

        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        input[type="text"] {
            flex: 1;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        /* button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        } */

        button:active {
            transform: translateY(0);
        }

        ul {
            list-style: none;
            margin: 1rem 0;
        }

        li {
            background-color: #f8fafc;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: var(--border-radius);
            border-right: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideIn 0.3s ease;
        }
        
        li .text {
            flex: 1;
        }
        
        li button {
            margin-left: 8px;
            padding: 6px 12px;
            background-color: var(--secondary-color);
            border: none;
            border-radius: var(--border-radius);
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        /* li button:hover {
            background-color: var(--primary-color);
        } */

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        textarea {
            width: 100%;
            height: 220px;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: var(--border-radius);
            resize: vertical;
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 1rem;
            transition: var(--transition);
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        .copy-success {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #10b981;
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--border-radius);
            animation: fadeInOut 2s ease;
            z-index: 1000;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -20px); }
            20% { opacity: 1; transform: translate(-50%, 0); }
            80% { opacity: 1; transform: translate(-50%, 0); }
            100% { opacity: 0; transform: translate(-50%, -20px); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .section {
                padding: 1.5rem;
            }

            .input-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>مدرب قواعد اللغة الإنجليزية</h1>
        
        <div class="section">
            <h2>القواعد التي أعرفها</h2>
            <div class="input-group">
                <input type="text" id="knownRuleInput" placeholder="أدخل قاعدة تعلمتها">
                <button onclick="addKnownRule()">تم</button>
            </div>
            <ul id="knownRulesList"></ul>
        </div>
        
        <div class="section">
            <h2>القواعد التي أريد التدرب عليها</h2>
            <div class="input-group">
                <input type="text" id="practiceRuleInput" placeholder="أدخل قاعدة للتدرب عليها">
                <button onclick="addPracticeRule()">حفظ</button>
            </div>
            <ul id="practiceRulesList"></ul>
        </div>
        
        <div class="section">
            <h2>التلقينة</h2>
            <textarea id="promptOutput" readonly></textarea>
            <button onclick="copyPrompt()">انسخ التلقينة</button>
        </div>
    </div>

    <script>
        // استرجاع القوائم من localStorage
        function loadLists() {
            let knownRules = JSON.parse(localStorage.getItem('knownRules')) || [];
            let practiceRules = JSON.parse(localStorage.getItem('practiceRules')) || [];
            return { knownRules, practiceRules };
        }

        function showCopySuccess() {
            const notification = document.createElement('div');
            notification.className = 'copy-success';
            notification.textContent = 'تم نسخ التلقينة بنجاح!';
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.remove();
            }, 2000);
        }

        // تحديث عرض القوائم وتوليد التلقينة
        function updateListDisplays() {
            const { knownRules, practiceRules } = loadLists();
            const knownRulesList = document.getElementById('knownRulesList');
            const practiceRulesList = document.getElementById('practiceRulesList');
            
            // تفريغ القوائم الحالية وإعادة توليدها
            knownRulesList.innerHTML = '';
            knownRules.forEach((rule, index) => {
                const li = document.createElement('li');
                const span = document.createElement('span');
                span.className = 'text';
                span.textContent = rule;
                li.appendChild(span);

                // زر تعديل للقواعد التي أعرفها
                const editBtn = document.createElement('button');
                editBtn.textContent = "تعديل";
                editBtn.onclick = () => editKnownRule(index);
                li.appendChild(editBtn);

                // زر حذف للقواعد التي أعرفها
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = "حذف";
                deleteBtn.onclick = () => deleteKnownRule(index);
                li.appendChild(deleteBtn);

                knownRulesList.appendChild(li);
            });
            
            practiceRulesList.innerHTML = '';
            practiceRules.forEach((rule, index) => {
                const li = document.createElement('li');
                const span = document.createElement('span');
                span.className = 'text';
                span.textContent = rule;
                li.appendChild(span);

                // زر تعديل للقواعد التي أريد التدرب عليها
                const editBtn = document.createElement('button');
                editBtn.textContent = "تعديل";
                editBtn.onclick = () => editPracticeRule(index);
                li.appendChild(editBtn);

                // زر حذف للقواعد التي أريد التدرب عليها
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = "حذف";
                deleteBtn.onclick = () => deletePracticeRule(index);
                li.appendChild(deleteBtn);

                // زر ترقية لتحويل القاعدة من قائمة التدرب إلى القواعد المعروفة
                const promoteBtn = document.createElement('button');
                promoteBtn.textContent = "ترقية";
                promoteBtn.onclick = () => promotePracticeRule(index);
                li.appendChild(promoteBtn);

                practiceRulesList.appendChild(li);
            });
            
            updatePrompt();
        }
        
        // وظيفة إضافة قاعدة إلى قائمة القواعد التي أعرفها
        function addKnownRule() {
            const knownRuleInput = document.getElementById('knownRuleInput');
            const rule = knownRuleInput.value.trim();
            if (rule === '') return;
            
            let { knownRules } = loadLists();
            knownRules.push(rule);
            localStorage.setItem('knownRules', JSON.stringify(knownRules));
            
            knownRuleInput.value = '';
            updateListDisplays();
        }
        
        // وظيفة إضافة قاعدة إلى قائمة القواعد التي أريد التدرب عليها
        function addPracticeRule() {
            const practiceRuleInput = document.getElementById('practiceRuleInput');
            const rule = practiceRuleInput.value.trim();
            if (rule === '') return;
            
            let { practiceRules } = loadLists();
            practiceRules.push(rule);
            localStorage.setItem('practiceRules', JSON.stringify(practiceRules));
            
            practiceRuleInput.value = '';
            updateListDisplays();
        }
        
        // دوال التعديل والحذف للقاعدة المعروفة
        function editKnownRule(index) {
            const { knownRules } = loadLists();
            const newRule = prompt("تعديل القاعدة:", knownRules[index]);
            if (newRule !== null && newRule.trim() !== "") {
                knownRules[index] = newRule.trim();
                localStorage.setItem('knownRules', JSON.stringify(knownRules));
                updateListDisplays();
            }
        }
        
        function deleteKnownRule(index) {
            const { knownRules } = loadLists();
            if (confirm("هل أنت متأكد من حذف هذه القاعدة؟")) {
                knownRules.splice(index, 1);
                localStorage.setItem('knownRules', JSON.stringify(knownRules));
                updateListDisplays();
            }
        }
        
        // دوال التعديل والحذف لقواعد التدرب عليها
        function editPracticeRule(index) {
            const { practiceRules } = loadLists();
            const newRule = prompt("تعديل القاعدة:", practiceRules[index]);
            if (newRule !== null && newRule.trim() !== "") {
                practiceRules[index] = newRule.trim();
                localStorage.setItem('practiceRules', JSON.stringify(practiceRules));
                updateListDisplays();
            }
        }
        
        function deletePracticeRule(index) {
            const { practiceRules } = loadLists();
            if (confirm("هل أنت متأكد من حذف هذه القاعدة؟")) {
                practiceRules.splice(index, 1);
                localStorage.setItem('practiceRules', JSON.stringify(practiceRules));
                updateListDisplays();
            }
        }
        
        // دالة ترقية قاعدة من قائمة التدرب عليها إلى قائمة القواعد المعروفة
        function promotePracticeRule(index) {
            const { practiceRules, knownRules } = loadLists();
            if (confirm("هل تريد ترقية هذه القاعدة إلى قائمة القواعد التي أعرفها؟")) {
                // إضافة القاعدة إلى القواعد المعروفة
                knownRules.push(practiceRules[index]);
                // حذفها من قائمة التدرب عليها
                practiceRules.splice(index, 1);
                localStorage.setItem('knownRules', JSON.stringify(knownRules));
                localStorage.setItem('practiceRules', JSON.stringify(practiceRules));
                updateListDisplays();
            }
        }
        
        // نموذج التلقينة مع المتغيرات
        function getPromptTemplate() {
            return `أنت معلم لغة إنجليزية محترف ومتخصص في قواعد اللغة. أعمل على صقل مهاراتي في استخدام قواعد اللغة وأتقن بالفعل القواعد التالية: [KNOWN_RULES]. الآن أرغب بالتدرب على قاعدة جديدة وهي: [PRACTICE_RULES].

مهمتك هي:
1. إعداد تمرين يتكون من نصوص أو جمل باللغة العربية لأترجمها إلى الإنجليزية، بحيث يشمل النص الذي يتم توليده تطبيق قاعدة [PRACTICE_RULES] مع دمج استخدام القواعد في [KNOWN_RULES] ضمن السياق.
2. بعد إرسال الترجمة، قم بتصحيح الأخطاء إن وُجدت مع شرح مختصر لكل خطأ، موضحاً كيفية دمج القواعد الجديدة مع القواعد السابقة.
3. إذا كانت الترجمة صحيحة، انتقل إلى نص آخر يتضمن نفس المتطلبات بحيث أتمرن على مزيد من الاستخدام العملي والتمازج بين القواعد.

اعلم أن الهدف هو تعزيز قاعدة [PRACTICE_RULES] مع التأكيد على إتقان القواعد في [KNOWN_RULES] حتى لا أنساها، مهما طال النص.`;
        }
        
        // تحديث التلقينة مع استبدال المتغيرات بالقيم المحفوظة
        function updatePrompt() {
            const { knownRules, practiceRules } = loadLists();
            let prompt = getPromptTemplate();
            const knownText = knownRules.length > 0 ? knownRules.join('، ') : 'لم يتم إدخال أي قاعدة';
            const practiceText = practiceRules.length > 0 ? practiceRules.join('، ') : 'لم يتم إدخال أي قاعدة';
            prompt = prompt.replace(/\[KNOWN_RULES\]/g, knownText);
            prompt = prompt.replace(/\[PRACTICE_RULES\]/g, practiceText);
            document.getElementById('promptOutput').value = prompt;
        }
        
        // وظيفة النسخ إلى الحافظة
        function copyPrompt() {
            const promptText = document.getElementById('promptOutput').value;
            navigator.clipboard.writeText(promptText).then(() => {
                showCopySuccess();
            }).catch(err => {
                alert('حدث خطأ أثناء النسخ: ' + err);
            });
        }

        // إضافة اختصارات لوحة المفاتيح
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                if (document.activeElement.id === 'knownRuleInput') {
                    addKnownRule();
                } else if (document.activeElement.id === 'practiceRuleInput') {
                    addPracticeRule();
                }
            }
        });
        
        document.addEventListener('DOMContentLoaded', updateListDisplays);
    </script>
</body>
</html>
